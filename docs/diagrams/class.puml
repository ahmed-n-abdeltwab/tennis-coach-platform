@startuml
enum Role {
  USER
  PREMIUM_USER
  ADMIN
  COACH
}

enum SessionStatus {
  SCHEDULED
  CONFIRMED
  COMPLETED
  CANCELLED
  NO_SHOW
}

class Account {
  id: UUID
  email: string
  passwordHash: string
  name: string
  role: Role
  gender: string
  age: int
  height: float
  weight: float
  bio: string
  credentials: string
  philosophy: string
  profileImage: string
  disability: boolean
  disabilityCause: string
  country: string
  address: string
  notes: string
  isActive: boolean
  isOnline: boolean
  createdAt: DateTime
  updatedAt: DateTime
  +sendMessage(to: Account, content: string)
  +setAvailability(times: TimeSlot[])
  +manageBookingType()
  +createDiscount()
}

class BookingType {
  id: UUID
  name: string
  description: string
  basePrice: Decimal
  isActive: boolean
  createdAt: DateTime
  updatedAt: DateTime
  +updatePrice(amount: float)
  +renameType(label: string)
}

class Session {
  id: UUID
  dateTime: DateTime
  durationMin: int
  price: Decimal
  isPaid: boolean
  status: SessionStatus
  notes: string
  paymentId: string
  discountCode: string
  calendarEventId: string
  createdAt: DateTime
  updatedAt: DateTime
}

class Discount {
  id: UUID
  code: string
  amount: Decimal
  expiry: DateTime
  useCount: int
  maxUsage: int
  isActive: boolean
  createdAt: DateTime
  updatedAt: DateTime
}

class Message {
  id: UUID
  content: string
  sentAt: DateTime
  senderType: Role
  receiverType: Role
}

class TimeSlot {
  id: UUID
  dateTime: DateTime
  durationMin: int
  isAvailable: boolean
  createdAt: DateTime
  updatedAt: DateTime
}

class RefreshToken {
  id: UUID
  token: string
  expiresAt: DateTime
  createdAt: DateTime
}

' Account relationships (Coach role)
Account "1" -- "N" BookingType : coach creates >
Account "1" -- "N" TimeSlot : coach manages >
Account "1" -- "N" Discount : coach creates >

' Account relationships (User/Coach sessions)
Account "1" -- "N" Session : user books >
Account "1" -- "N" Session : coach provides >

' Account relationships (Messages)
Account "1" -- "N" Message : sends >
Account "1" -- "N" Message : receives >

' Account relationships (Auth)
Account "1" -- "N" RefreshToken : has >

' Session relationships
Session "N" -- "1" BookingType : has type >
Session "N" -- "1" TimeSlot : scheduled at >
Session "N" -- "0..1" Discount : applies >
Session "1" -- "N" Message : contains >

note right of Account
  Unified model for all user types.
  Role field determines capabilities:
  - USER: Can book sessions
  - PREMIUM_USER: Enhanced user features
  - ADMIN: System administration
  - COACH: Can create booking types,
    manage availability, create discounts
end note
@enduml
